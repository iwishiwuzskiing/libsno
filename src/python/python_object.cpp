#include <sno/python/python_object.h>

////////////////////////////////////////////////////////////////////////////////

void so::Python_object::get_as(Python_object& obj) const
{
  obj = so::Python_object(m_obj, true);
}

////////////////////////////////////////////////////////////////////////////////

void so::Python_object::get_as(double& dbl) const
{
  PyErr_Clear(); //TODO: PyErr_Fetch() then PyErr_Restore() instead?
  double temp_d = PyFloat_AsDouble(m_obj);
  PyObject* err = PyErr_Occurred();
  if(err)
  {
    throw so::Invalid_argument("Failed to convert to double");
  }
  else
  {
    dbl = temp_d;
  }
}

////////////////////////////////////////////////////////////////////////////////

void so::Python_object::get_as(std::string& str) const
{
  PyObject* repr = PyObject_Repr(m_obj);
  str = std::string(PyUnicode_AsUTF8(repr));
}

////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
